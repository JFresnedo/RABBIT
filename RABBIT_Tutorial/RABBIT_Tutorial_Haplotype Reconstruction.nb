(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31043,        786]
NotebookOptionsPosition[     26786,        647]
NotebookOutlinePosition[     28091,        686]
CellTagsIndexPosition[     28013,        681]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 TogglerBox[2, {1->
  OverlayBox[{
   TagBox[GridBox[{
      {
       GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRIz
UFAKiEGSLED8//9/gvjRo0fsN27cELp69arY+fPnpZExPn137tzhBqrRBGJ/
ID4CxMfRMTZ9L168YL5w4YIaUD4AiC8C8Qcg/gvE/9AxFreC7PQD4gtA/BGq
7j8ujKz3+fPnLFC9b6H24dSHTf/FixfVofYSpRdZPzSsAqBuJkovsn5oOF8k
5F9s+h88eMBBjt0w/devXxcGso+S4m9k/ZcuXRKHpgeS3A7TD0wrkpToPw9J
ywOmn1L3Uxp+lMYfpemH0vRLjfwDjQey8y9a+fGOWDPwlF+gsPhEKDywlZ8g
d0D9EniexPITGd++fZv3PBnlN6764zxa3QHCAIDESDs=
         "], {{0, 26}, {16, 0}}, {0, 255},
         ColorFunction->RGBColor],
        BaseStyle->"ImageGraphics",
        ImageSize->Magnification[1],
        ImageSizeRaw->{16, 26},
        PlotRange->{{0, 16}, {0, 26}}], 
       GraphicsBox[RasterBox[CompressedData["
1:eJzt2V1vVFUUBuBGTfTSSygthYYKNHyVinrrpbcYfwBEJN5gUkyMfw9KKaVw
KCkQKCW1RNIQKg1gEE3QtdN10pMRZCaBzNQ+kzxt5nzstfeZfbPOu/vkD8e/
e6+vr+/sR/Hn+ImfvpyYOPHz1x/Hl2/OnP3+9JlT33515sdTp09NfHHy/TjY
H6592Nf3QfyvqmpHBwbCYNr5GoMNAw2d1AEAADa3/obtLba1aJ7rb4xR9x1D
YVfYHYbDnjASPgn7wv4wGg6Eg+FQOByOhLEwnj4Nx8Jn6fM21dcfyzHq8cay
xuGseTDnMJpz2pdzHMk5D+caduWa6v6p+czafU71s6p1+/cGAADYqt52/9va
++6tXt331j3v0TTeoj5e966v6lv3Vv/uWfWr9LJm9tzMpN+UW3eaVV9s00yY
CzfC7bAQFhvuhjt57maYD9er9c+VcDlcCtMd1AQAADafqXQhTabz6VyL+vhk
Xl/uLX1D6UFmw9VwrVrvL0o/cqta7ztKD3Iv/BLuh1/DSngYHoXfwlp4Ep6F
38Pz8Ed4Ef5Mf71Gff5F3vM8x3iWY65ljUdZcyXncD/ndC/neDvnfCPXcC3X
NJtrnG48r3afU/2s6uc11QO/OwAAwFbzLvrfksWVjK30kSV3KxncUlgOD6qN
vnc1PK42+t7iaaq/r+U1q9VG3/ogx1rKse9krfmsrV+l15R9WDLmkjWXzLl8
yvuVsmdLJl3eu5R9XN7BNLPrhTxX3seUvT3TQc2Xbfr7LWq3JgAAwH95m33K
u9Dt5wMAAMDmp2dlK+vGnu/2+yQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYPN42aZu
1AQAAAAAAICtrNsZIXRTN/b8xTbNhLlwI9wOC2Gx4W64k+duhvlwvVr/XAmX
w6Uw3UFNAAAAAAAA6EVT6UKaTOfTuRb18cm8vtxbcrOSwc2Gq9V6FlcytlvV
eu5WMrilsBwehJXwMKyGx2EtPElPU/19La9ZzXtWcozlHHMxa9zKmnM5h9mc
03Rjfe2uq15bvb6pHvid2NzKPiwZc8maS+ZcPiWDLnu2ZNIlmy77uGTVzex6
Ic+VbLvs7ZkOau7owEAYTDtfY7BhoKGTOgAAAAAAANDr+hu2t9jWonmuvzFG
nbsNhd1hOOwJI2Fv2B9Gw4FwMBwKR8JYOJrGW9THx/LaQ3nvgRxrf449krWG
s/ZQtZH3NdfY7rrqtdW6/fvw/9LMnpuZ9Jty646y6n8AhCP7tg==
         "], {{0, 26}, {2000, 0}}, {0, 255},
         ColorFunction->RGBColor],
        BaseStyle->"ImageGraphics",
        ImageSize->Magnification[1],
        ImageSizeRaw->{2000, 26},
        PlotRange->{{0, 2000}, {0, 26}}], 
       GraphicsBox[RasterBox[CompressedData["
1:eJy9lktLQkEUxyVdCBIELaxctYq+QduWbcKMPoCSRRsDC6JPp+Lj4vuq+EBc
iBtFfIYrpU7nPzQiN++9vmrgp/dx5j8z55w5c099z56HPYvF8mLnH4/37TIY
9L7fHvDNXeDl6THgv78KvPof/cELn5UfnjBHjI3J5/OudVBV9bhUKjmbzaad
iCxmcB9lAxKMmzmv1+v7JvpfG/DJjJkic8NrOut0OlYdfdoCjPXBqMx1q9Vy
7FhfgvX0MUa73bYZ6edyuTnrvPsZQ4Wv9PTRL5vNroTOGIiJu9FoOLT6UjuT
yVAqlaJkMin+0+m0YPEZbHTGQDwKyKtl+ugHjdFoRIVCgeLxOCUSCQGua7Ua
9Xo9YQNbozXI/aHVZ//RcDik2WxG5XKZwuGwANdo0JfrNIhDvFqtHi7zD+YW
i8VoMBgIvWKxKEDrdrtiHbAxiAF8pHAf5zJ9+Bca0WiUxuMxydbv98U64CvY
wNZgTyioI9r8QR/EEvrQUhRlrh8Kheb6sDHTZ1xG84ePMP/pdPpr/tvoL/of
Mcb9Jv7X+mcxP2X+QCMSiYh5VyoVMQbXMbP81I2vzM/JZCLyX+a+BPmPvbFN
fmr36pr713B/rVp7THy/tD6Y1cjF5zrahvVtB5jW5y21B/kVzpc1kecjfK53
Pu7kfNfO+x+/T/70++ob7NUEtQ==
         "], {{0, 26}, {24, 0}}, {0, 255},
         ColorFunction->RGBColor],
        BaseStyle->"ImageGraphics",
        ImageSize->Magnification[1],
        ImageSizeRaw->{24, 26},
        PlotRange->{{0, 24}, {0, 26}}]}
     },
     AutoDelete->False,
     GridBoxItemSize->{"Columns" -> {Automatic, 
         Scaled[0.6], Automatic}},
     GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}],
    "Grid"], 
   PaneBox[
    StyleBox[
     RowBox[{
     "Background", " ", "images", " ", "and", " ", "text", " ", "colors", " ",
       "have", " ", "been", " ", "adjusted", " ", "for", " ", "editing", " ", 
      RowBox[{"purposes", "."}]}],
     LineBreakWithin->False,
     FontFamily->"Helvetica",
     FontSize->12,
     FontColor->GrayLevel[0.4]],
    Alignment->Center,
    ImageSize->Scaled[0.5],
    ScrollPosition->{0., 0.}]},
   Alignment->{Center, Center}], 2->""}, "1"]], "SlideShowNavigationBar", \
"FirstSlide",
 CellMargins->{{0, 0}, {0, 0}},
 CellFrameLabelMargins->2,
 CellSize->{Inherited, 30},
 CellChangeTimes->{3.712565939837493*^9},
 TextAlignment->Center,
 CellTags->"SlideShowHeader"],

Cell["Haplotye reconstruction in multiparental populations", "Title",
 CellChangeTimes->{{3.559948352753993*^9, 3.559948353292842*^9}, {
  3.7124882074672294`*^9, 3.712488257611842*^9}, {3.7124882877808585`*^9, 
  3.712488296549735*^9}, {3.712488336603134*^9, 3.712488370680542*^9}, {
  3.712489620732885*^9, 3.71248963942955*^9}, {3.7125557167013073`*^9, 
  3.7125557196296005`*^9}, {3.712563313075924*^9, 3.7125633155081673`*^9}, {
  3.7126610975799522`*^9, 3.7126611003792324`*^9}, {3.7130042229440703`*^9, 
  3.713004234887869*^9}, {3.7130866074034796`*^9, 3.7130866127869415`*^9}, {
  3.713685479989019*^9, 3.713685485004819*^9}}],

Cell["\<\
Chaozhi Zheng
Wageningen University and Research
1 Sept 2017\
\>", "Subtitle",
 CellChangeTimes->{{3.7124883846327324`*^9, 3.712488417762045*^9}, {
   3.712545847614869*^9, 3.7125458501343193`*^9}, 3.7126627700864563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Outlines", "Section",
 CellChangeTimes->{{3.7125552567970357`*^9, 3.7125552616695232`*^9}, {
  3.7125712529518266`*^9, 3.712571286152534*^9}, {3.7126611120037813`*^9, 
  3.712661115612142*^9}}],

Cell[CellGroupData[{

Cell["Selection a mapping population", "Item",
 CellChangeTimes->{{3.712555267725128*^9, 3.712555289584906*^9}, {
   3.7126611251328897`*^9, 3.7126611285322294`*^9}, {3.7126611838469357`*^9, 
   3.712661186926244*^9}, {3.7129983334790506`*^9, 3.7129983558098755`*^9}, 
   3.712998435762632*^9, {3.712998742239147*^9, 3.712998754318355*^9}}],

Cell["Simulate genomic data", "Item",
 CellChangeTimes->{{3.712555267725128*^9, 3.712555289584906*^9}, {
   3.7126611251328897`*^9, 3.7126611285322294`*^9}, {3.7126611838469357`*^9, 
   3.712661186926244*^9}, {3.7129983334790506`*^9, 3.7129983558098755`*^9}, 
   3.712998435762632*^9}],

Cell["Ancestral inference", "Item",
 CellChangeTimes->{{3.712555267725128*^9, 3.712555289584906*^9}, {
  3.7126611251328897`*^9, 3.7126611285322294`*^9}, {3.7126611838469357`*^9, 
  3.712661186926244*^9}, {3.7129983334790506`*^9, 3.7129983539036846`*^9}, {
  3.712998491934827*^9, 3.712998491935827*^9}, {3.7129985569191*^9, 
  3.712998560887497*^9}, {3.7130042468300686`*^9, 3.7130042563898673`*^9}, {
  3.713086620792939*^9, 3.7130866239286256`*^9}}],

Cell["Visualize output", "Item",
 CellChangeTimes->{{3.712555267725128*^9, 3.712555289584906*^9}, {
  3.7126611251328897`*^9, 3.7126611285322294`*^9}, {3.7126611838469357`*^9, 
  3.712661186926244*^9}, {3.7129983334790506`*^9, 3.7129983539036846`*^9}, {
  3.712998492676901*^9, 3.7129985260304265`*^9}, {3.713004259325867*^9, 
  3.713004264740867*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Load MagicReconstruct", "Section",
 CellChangeTimes->{{3.712488572095068*^9, 3.7124885903118896`*^9}, {
  3.712661193454692*^9, 3.712661195566903*^9}, {3.713004272452467*^9, 
  3.713004278285467*^9}}],

Cell[TextData[{
 "First set directory to the directory of the Mathematica packages.\nThen \
load the package by functions ",
 StyleBox["Needs ",
  FontWeight->"Bold"],
 "or",
 StyleBox[" Get",
  FontWeight->"Bold"],
 ". \nUse  the directory of the current notebook as the work directory. "
}], "Text",
 CellChangeTimes->{{3.7124888322006674`*^9, 3.7124889533967857`*^9}, {
   3.71248902506355*^9, 3.712489064024446*^9}, {3.7124891199146256`*^9, 
   3.7124891306116953`*^9}, {3.7124893770521326`*^9, 3.712489387308158*^9}, 
   3.712489952048137*^9, {3.713007989420546*^9, 3.713008001036708*^9}}],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
       "\"\<RABBIT_Packages\>\""}], "}"}], "]"}], "]"}], ";"}], 
  "Input"], "\n", 
 StyleBox[
  RowBox[{"Get", "[", "\"\<MagicReconstruct`\>\"", "]"}], 
  "Input"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "Input"]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.71248867121898*^9, 3.7124887092455773`*^9}, 
   3.712488977430787*^9, 3.7124890112081647`*^9, {3.71256286852497*^9, 
   3.7125628711568317`*^9}, {3.7125631980172358`*^9, 
   3.7125632034967833`*^9}, {3.7125677993085375`*^9, 
   3.7125678104446507`*^9}, {3.7125706076727066`*^9, 3.71257060791273*^9}, {
   3.7125706573308487`*^9, 3.712570679802483*^9}, {3.712909488643896*^9, 
   3.712909488867919*^9}, {3.712909519403965*^9, 3.712909519564981*^9}, {
   3.7130004153224187`*^9, 3.7130004169385805`*^9}, 3.713000493132764*^9, {
   3.7130079840760117`*^9, 3.71300798455606*^9}, {3.713008372826394*^9, 
   3.713008377314638*^9}}],

Cell["Get help information on functions or options by ?", "Text",
 CellChangeTimes->{{3.7130080497435703`*^9, 3.713008086431429*^9}, {
  3.713008186931653*^9, 3.7130082336931095`*^9}}],

Cell[BoxData[
 RowBox[{"?", "\"\<MagicReconstruct`*\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.712934846712282*^9, 3.7129348579594064`*^9}, {
   3.713008092239805*^9, 3.7130081398583546`*^9}, {3.713008197516507*^9, 
   3.7130082015645103`*^9}, 3.7130083863305397`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Help on magicReconstruct", "Section",
 CellChangeTimes->{{3.7126636539740114`*^9, 3.712663662743085*^9}, {
  3.713004470344252*^9, 3.713004474031252*^9}, {3.7130864936944647`*^9, 
  3.713086499613472*^9}, {3.7130873962622666`*^9, 3.7130873995502663`*^9}}],

Cell["Usage of magicReconstruct", "Text",
 CellChangeTimes->{{3.713086658122602*^9, 3.7130867058582196`*^9}}],

Cell[BoxData[
 RowBox[{"?", "magicReconstruct"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.712663673719577*^9, 3.712663681343135*^9}, {
   3.712663744258601*^9, 3.7126637472609015`*^9}, {3.712663965250413*^9, 
   3.7126639654334316`*^9}, {3.713004477168252*^9, 3.7130045013910522`*^9}, 
   3.713086646799137*^9}],

Cell["Options of magicReconstruct", "Text",
 CellChangeTimes->{{3.713086689920619*^9, 3.7130867010678997`*^9}}],

Cell[BoxData[{
 RowBox[{"Options", "[", "magicReconstruct", "]"}], "\[IndentingNewLine]", 
 RowBox[{"?", "reconstructAlgorithm"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.712663673719577*^9, 3.712663681343135*^9}, {
  3.712663744258601*^9, 3.7126637472609015`*^9}, {3.712663965250413*^9, 
  3.7126639654334316`*^9}, {3.713004477168252*^9, 3.7130045013910522`*^9}, {
  3.713086651316484*^9, 3.713086651516464*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Select an illustrative population", "Section",
 CellChangeTimes->{{3.71249011950283*^9, 3.712490125815257*^9}, 
   3.7124902747564926`*^9, {3.7124904175931325`*^9, 3.712490419097283*^9}, {
   3.712661370861351*^9, 3.7126614045026927`*^9}, {3.713004408876853*^9, 
   3.713004414603853*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"codels", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<f2\>\"", ",", "\"\<2wayril-self6\>\"", ",", 
     "\"\<8wayril-self2\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"popcode", "=", 
   RowBox[{"codels", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imagesizels", "=", 
   RowBox[{"{", 
    RowBox[{"200", ",", "100", ",", "500"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pedls", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"pedigree", "=", 
       RowBox[{"compilePopPedigree", "[", 
        RowBox[{"codels", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<popcode = \>\"", "<>", 
          RowBox[{"codels", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"pedigreePlot", "[", 
          RowBox[{"pedigree", ",", 
           RowBox[{"ImageSize", "\[Rule]", 
            RowBox[{"imagesizels", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "codels", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"TabView", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"codels", ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "\"\<F2\>\"", ",", "\"\<2-way RIL\>\"", ",", "\"\<8-way RIL\>\""}], 
         "}"}], "\[Rule]", "pedls"}], "]"}]}], "}"}], "]"}], ",", 
   RowBox[{"Dynamic", "[", "popcode", "]"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "All"}]}], "]"}]}], "Input",
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.712661438120638*^9, 3.7126617876452365`*^9}, {
  3.7126618596886153`*^9, 3.712661982331455*^9}, {3.7126620570465097`*^9, 
  3.712662097015083*^9}, {3.712662132705038*^9, 3.7126621525536146`*^9}, {
  3.712662188651019*^9, 3.712662196476802*^9}, {3.7126622378371053`*^9, 
  3.712662288662362*^9}, {3.712662376257676*^9, 3.712662376545705*^9}, {
  3.713005937084241*^9, 3.713005944227955*^9}, {3.7205144233808513`*^9, 
  3.720514423763851*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Simulate genomic data", "Section",
 CellChangeTimes->{{3.712662679315811*^9, 3.7126626850999875`*^9}, {
  3.712896900846073*^9, 3.7128969248946676`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"simpedinforfile", "=", 
   RowBox[{"simPedigreeInfor", "[", 
    RowBox[{"popcode", ",", 
     RowBox[{"sampleSize", "\[Rule]", "20"}], ",", 
     RowBox[{"outputFileID", "\[Rule]", "\"\<Example\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"datafiles", "=", 
   RowBox[{"magicGeneDropping", "[", 
    RowBox[{
    "\"\<Arabidopsis_MAGIC_19FounderHaplo.csv\>\"", ",", "simpedinforfile", 
     ",", 
     RowBox[{"outputFileID", "\[Rule]", "\"\<Example\>\""}], " ", ",", 
     RowBox[{"founderGenotypeMissing", "\[Rule]", "0.1"}], ",", 
     RowBox[{"offspringGenotypeMissing", "\[Rule]", "0.1"}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.712564381266658*^9, {3.71256441858858*^9, 3.7125644462295413`*^9}, 
   3.7125645761070924`*^9, {3.712564691408186*^9, 3.7125647008221273`*^9}, {
   3.712564782826892*^9, 3.712564783520961*^9}, {3.7125654896048*^9, 
   3.712565493218958*^9}, {3.712565543278351*^9, 3.712565544740497*^9}, 
   3.712566514407346*^9, {3.712659546532776*^9, 3.7126595599897127`*^9}, {
   3.7126595962859325`*^9, 3.7126596177268724`*^9}, {3.712659667491228*^9, 
   3.7126597379492292`*^9}, 3.712659768838303*^9, {3.712659821792576*^9, 
   3.7126598386806517`*^9}, {3.712659903906947*^9, 3.712659904240981*^9}, {
   3.7126628745140514`*^9, 3.712662882067405*^9}, {3.71266293699708*^9, 
   3.712662986703043*^9}, {3.7126633210133905`*^9, 3.712663328114896*^9}, {
   3.7126637290654907`*^9, 3.712663730953475*^9}, {3.7126640143310947`*^9, 
   3.7126640727201157`*^9}, {3.7126641129691253`*^9, 3.712664129215144*^9}, {
   3.7126644421067657`*^9, 3.712664453075461*^9}, {3.7128970789572115`*^9, 
   3.712897102182519*^9}, {3.712897554590945*^9, 3.7128976645298862`*^9}, {
   3.712900084097345*^9, 3.712900106360965*^9}, {3.7129781602892976`*^9, 
   3.712978160873356*^9}, 3.7129782413473616`*^9, {3.7129782842290306`*^9, 
   3.7129782970075054`*^9}, {3.7130007011026535`*^9, 3.713000701292673*^9}, {
   3.713000732439372*^9, 3.7130007456214857`*^9}, {3.713004380393857*^9, 
   3.713004380581857*^9}, {3.713005420746656*^9, 3.713005420936675*^9}, {
   3.713005922475795*^9, 3.7130059255548983`*^9}, {3.7130077484037027`*^9, 
   3.7130077750841656`*^9}, 3.7130697730940375`*^9, {3.7134302729402637`*^9, 
   3.7134302983047934`*^9}, 3.7190484986433234`*^9, {3.7205144295968513`*^9, 
   3.720514430138851*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Ancestral inference", "Section",
 CellChangeTimes->{{3.7130864639238462`*^9, 3.713086476313404*^9}, {
  3.7130865845189714`*^9, 3.7130865890703154`*^9}, {3.713086723201701*^9, 
  3.7130867267127013`*^9}}],

Cell[BoxData[{
 RowBox[{"genodatafile", "=", 
  RowBox[{"Last", "[", "datafiles", "]"}]}], "\n", 
 RowBox[{"model", "=", "\"\<jointModel\>\""}], "\n", 
 RowBox[{"outputfile", "=", 
  RowBox[{"magicReconstruct", "[", 
   RowBox[{"genodatafile", ",", "model", ",", "simpedinforfile", ",", 
    RowBox[{
    "reconstructAlgorithm", "\[Rule]", "\"\<origPosteriorDecoding\>\""}], ",", 
    RowBox[{"outputFileID", "\[Rule]", "\"\<Example\>\""}], ",", 
    RowBox[{"isPrintTimeElapsed", "\[Rule]", "True"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.713086521529276*^9, 3.713086525928836*^9}, {
  3.713087646495267*^9, 3.7130876482462664`*^9}, {3.7130877657756667`*^9, 
  3.7130877703984666`*^9}}],

Cell["Summarize the output of magicReconstruct", "Text",
 CellChangeTimes->{{3.7130865470063276`*^9, 3.7130865543645916`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"condprobfile", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"outputfile", ",", 
     RowBox[{"\"\<.txt\>\"", "\[Rule]", "\"\<_DiploProb.csv\>\""}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"saveCondProb", "[", 
  RowBox[{"outputfile", ",", "condprobfile", ",", "\"\<diplotype\>\""}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6257365160056896`*^9, 3.6257365362285995`*^9}, {
   3.62573656766774*^9, 3.6257365781874533`*^9}, {3.625809319399985*^9, 
   3.6258093403839846`*^9}, {3.6258095379342237`*^9, 
   3.6258095414252586`*^9}, {3.6258216820758944`*^9, 
   3.6258217104111776`*^9}, {3.625827496851268*^9, 3.6258274983222823`*^9}, 
   3.626361566066131*^9, {3.627028299758605*^9, 3.627028317612319*^9}, {
   3.7130054781635647`*^9, 3.713005556197733*^9}, {3.7130055876348615`*^9, 
   3.7130055892710247`*^9}, 3.713006308577489*^9, {3.7130671641210732`*^9, 
   3.713067164301091*^9}, {3.7135093963272114`*^9, 3.713509406862811*^9}, {
   3.713510526215211*^9, 3.7135105304862113`*^9}, {3.719288732548134*^9, 
   3.7192887661492825`*^9}, {3.719288867337777*^9, 3.719288867800823*^9}, {
   3.719299837674735*^9, 3.7192998388747354`*^9}, {3.7193039827623353`*^9, 
   3.7193039913449354`*^9}, {3.7205142171280513`*^9, 3.720514222480051*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"condprobfile", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"outputfile", ",", 
     RowBox[{"\"\<.txt\>\"", "\[Rule]", "\"\<_HaploProb.csv\>\""}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"saveCondProb", "[", 
  RowBox[{"outputfile", ",", "condprobfile", ",", "\"\<haplotype\>\""}], 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6257365160056896`*^9, 3.6257365362285995`*^9}, {
   3.62573656766774*^9, 3.6257365781874533`*^9}, {3.625809319399985*^9, 
   3.6258093403839846`*^9}, {3.6258095379342237`*^9, 
   3.6258095414252586`*^9}, {3.6258216820758944`*^9, 
   3.6258217104111776`*^9}, {3.625827496851268*^9, 3.6258274983222823`*^9}, 
   3.626361566066131*^9, {3.627028299758605*^9, 3.627028317612319*^9}, {
   3.7130054781635647`*^9, 3.713005556197733*^9}, {3.7130055876348615`*^9, 
   3.7130055892710247`*^9}, 3.713006308577489*^9, {3.7130671641210732`*^9, 
   3.713067164301091*^9}, {3.7135093963272114`*^9, 3.713509406862811*^9}, {
   3.713510526215211*^9, 3.7135105304862113`*^9}, {3.719288732548134*^9, 
   3.7192887661492825`*^9}, {3.719288867337777*^9, 3.719288867800823*^9}, {
   3.719299837674735*^9, 3.7192998388747354`*^9}, {3.7193039827623353`*^9, 
   3.7193039913449354`*^9}, {3.7205142171280513`*^9, 3.720514222480051*^9}, {
   3.720514537315851*^9, 3.7205145448188515`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"summaryfile", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"outputfile", ",", 
     RowBox[{"\"\<.txt\>\"", "\[Rule]", "\"\<_Summary.csv\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"saveAsSummaryMR", "[", 
  RowBox[{"outputfile", ",", "summaryfile"}], "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6257365160056896`*^9, 3.6257365362285995`*^9}, {
   3.62573656766774*^9, 3.6257365781874533`*^9}, {3.625809319399985*^9, 
   3.6258093403839846`*^9}, {3.6258095379342237`*^9, 
   3.6258095414252586`*^9}, {3.6258216820758944`*^9, 
   3.6258217104111776`*^9}, {3.625827496851268*^9, 3.6258274983222823`*^9}, 
   3.626361566066131*^9, {3.627028299758605*^9, 3.627028317612319*^9}, {
   3.7130054781635647`*^9, 3.713005556197733*^9}, {3.7130055876348615`*^9, 
   3.7130055892710247`*^9}, 3.713006308577489*^9, {3.7130671641210732`*^9, 
   3.713067164301091*^9}, {3.7135093963272114`*^9, 3.713509406862811*^9}, {
   3.713510526215211*^9, 3.7135105304862113`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Visualize genotype probabilities", "Section",
 CellChangeTimes->{{3.7130056968343277`*^9, 3.7130057323478565`*^9}}],

Cell["\<\
Posterior haplotype/genotype probabilities for each sampled offspring. \
\>", "Text",
 CellChangeTimes->{{3.713005691907835*^9, 3.713005694218066*^9}, 
   3.7130057346986904`*^9, {3.713085420005316*^9, 3.7130854276090755`*^9}, {
   3.7130855332660055`*^9, 3.7130855345771365`*^9}}],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"plotAncestryProbGUI", "[", 
    RowBox[{"summaryfile", ",", 
     RowBox[{"datafiles", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"AnimationRunning", "\[Rule]", "False"}], ",", 
     RowBox[{"linkageGroupSet", "\[Rule]", "set"}], ",", 
     RowBox[{"isPlotGenoProb", "\[Rule]", 
      RowBox[{"!", "bool"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Row", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"set", ",", "All", ",", "\"\<LinkageGroups\>\""}], "}"}], 
          ",", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"Subsets", "[", 
             RowBox[{
              RowBox[{"Range", "[", "5", "]"}], ",", "2"}], "]"}], ",", 
            RowBox[{"1", "\[Rule]", "All"}]}], "]"}]}], "}"}], "]"}], ",", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "bool", ",", "True", ",", 
            "\"\<Ancestral Haplotyple Probability\>\""}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"Spacer", "[", "20", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7130837977025394`*^9, 3.7130838375437126`*^9}, {
   3.7130843693157167`*^9, 3.7130843884512215`*^9}, 3.713085158606434*^9, {
   3.7130852523903875`*^9, 3.7130852565125957`*^9}, {3.713085574562923*^9, 
   3.7130856742738714`*^9}, {3.713085779876197*^9, 3.713085789508956*^9}, {
   3.713086883418482*^9, 3.7130868872384815`*^9}, 3.713087233586467*^9, {
   3.713087296774067*^9, 3.7130873071248665`*^9}, {3.713416547595575*^9, 
   3.7134165678001747`*^9}, {3.7135087764634113`*^9, 3.713508784470011*^9}, {
   3.713508852506611*^9, 3.713508902750411*^9}, {3.7135090036278114`*^9, 
   3.713509168557211*^9}, {3.713509456923811*^9, 3.7135094574198112`*^9}, {
   3.713513018831611*^9, 3.713513019377611*^9}, {3.7164764031627703`*^9, 
   3.7164764037006197`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["", "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],

Cell[CellGroupData[{

Cell["Refereces", "Section",
 CellChangeTimes->{{3.6272780402448635`*^9, 3.627278046697541*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Zheng, C., Boer, M. P., and Eeuwijk, F. A. 2018.  \
Recursive algorithms for modeling genomic ancestry blocks in a fixed \
pedigree. Manuscript",
 FontSize->18]], "Item",
 CellChangeTimes->{{3.627278059699891*^9, 3.627278085784587*^9}, {
   3.627281116497564*^9, 3.627281116497564*^9}, 3.6396560568286266`*^9, {
   3.6422337076948814`*^9, 3.642233711804964*^9}, {3.7281124711168165`*^9, 
   3.7281124877948785`*^9}, {3.7281125198364615`*^9, 3.728112528907566*^9}}],

Cell[TextData[StyleBox["Zheng, C., Boer, M. P., and Eeuwijk, F. A. 2015. \
Reconstruction of genome ancestry blocks in multiparental populations. \
Genetics. ",
 FontSize->18]], "Item",
 CellChangeTimes->{{3.627278059699891*^9, 3.627278085784587*^9}, {
   3.627281116497564*^9, 3.627281116497564*^9}, 3.6396560568286266`*^9, {
   3.6422337076948814`*^9, 3.642233711804964*^9}}],

Cell[TextData[StyleBox["Zheng, C. 2015. Modeling X-linked ancestral origins \
in multiparental populations. G3: Genes | Genomes | Genetics. ",
 FontSize->18]], "Item",
 CellChangeTimes->{{3.627278059699891*^9, 3.627278085784587*^9}, {
   3.627281116497564*^9, 3.627281127100564*^9}, {3.639655993885026*^9, 
   3.6396560073597965`*^9}, 3.639656055055525*^9, 3.642233714755023*^9}],

Cell[TextData[StyleBox["Zheng, C., Boer, M. P., and Eeuwijk, F. A. 2014. A \
general modeling framework for genome ancestral origins in multi-parental \
populations. Genetics. 198: 87-101.",
 FontSize->18]], "Item",
 CellChangeTimes->{{3.627278059699891*^9, 3.627278085784587*^9}, {
  3.627281116497564*^9, 3.627281146343564*^9}, {3.728112449267836*^9, 
  3.7281124655296593`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1902, 980},
WindowMargins->{{-9, Automatic}, {Automatic, 0}},
TaggingRules->{"SlideShow" -> True},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->FrontEnd`FileName[{"SlideShow"}, "Sapphire.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "SlideShowHeader"->{
  Cell[580, 22, 4356, 95, 82, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[5846, 140, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[7658, 184, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[10303, 253, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[11697, 290, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[14489, 369, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[17210, 426, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[22149, 531, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"],
  Cell[24902, 602, 64, 1, 81, "SlideShowNavigationBar",
   CellTags->"SlideShowHeader"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"SlideShowHeader", 27190, 659}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4356, 95, 82, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[4939, 119, 635, 8, 504, "Title"],
Cell[5577, 129, 232, 6, 226, "Subtitle"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5846, 140, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[5935, 145, 199, 3, 131, "Section"],
Cell[CellGroupData[{
Cell[6159, 152, 340, 4, 59, "Item"],
Cell[6502, 158, 285, 4, 59, "Item"],
Cell[6790, 164, 452, 6, 59, "Item"],
Cell[7245, 172, 352, 5, 59, "Item"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7658, 184, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[7747, 189, 206, 3, 131, "Section"],
Cell[7956, 194, 594, 13, 123, "Text"],
Cell[8553, 209, 1219, 27, 120, "Input",
 InitializationCell->True],
Cell[9775, 238, 184, 2, 59, "Text"],
Cell[9962, 242, 292, 5, 61, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[10303, 253, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[10392, 258, 261, 3, 131, "Section"],
Cell[10656, 263, 109, 1, 59, "Text"],
Cell[10768, 266, 330, 6, 61, "Input",
 InitializationCell->True],
Cell[11101, 274, 111, 1, 59, "Text"],
Cell[11215, 277, 433, 7, 91, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11697, 290, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[11786, 295, 295, 4, 131, "Section"],
Cell[12084, 301, 2356, 62, 19, "Input",
 CellOpen->False,
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14489, 369, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[14578, 374, 159, 2, 131, "Section"],
Cell[14740, 378, 2421, 42, 120, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17210, 426, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[17299, 431, 210, 3, 131, "Section"],
Cell[17512, 436, 720, 14, 149, "Input",
 InitializationCell->True],
Cell[18235, 452, 126, 1, 59, "Text"],
Cell[18364, 455, 1320, 23, 91, "Input",
 InitializationCell->True],
Cell[19687, 480, 1372, 24, 91, "Input",
 InitializationCell->True],
Cell[21062, 506, 1038, 19, 91, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22149, 531, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[22238, 536, 121, 1, 131, "Section"],
Cell[22362, 539, 291, 5, 59, "Text"],
Cell[22656, 546, 2197, 50, 149, "Input",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24902, 602, 64, 1, 81, "SlideShowNavigationBar",
 CellTags->"SlideShowHeader"],
Cell[CellGroupData[{
Cell[24991, 607, 96, 1, 131, "Section"],
Cell[CellGroupData[{
Cell[25112, 612, 488, 7, 53, "Item"],
Cell[25603, 621, 377, 6, 53, "Item"],
Cell[25983, 629, 379, 5, 53, "Item"],
Cell[26365, 636, 381, 6, 53, "Item"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     33287,        680]
NotebookOptionsPosition[     32162,        640]
NotebookOutlinePosition[     32536,        656]
CellTagsIndexPosition[     32493,        653]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ParentDirectory", "[", 
        RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
       "\"\<RABBIT_Packages\>\""}], "}"}], "]"}], "]"}], ";"}], 
  "Input"], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<MagicGeneDropping`\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.584872542079793*^9, 3.5848725501762066`*^9}, {
   3.5849452270332193`*^9, 3.5849452273140197`*^9}, {3.584960367972127*^9, 
   3.5849604080457983`*^9}, {3.5849617233742113`*^9, 
   3.5849617338574295`*^9}, {3.585372426468047*^9, 3.585372427123248*^9}, {
   3.5853754731435986`*^9, 3.5853754735179996`*^9}, {3.604206318299*^9, 
   3.604206318709*^9}, 3.6070217827964497`*^9, {3.6072486275406322`*^9, 
   3.6072486313306704`*^9}, {3.6132816696601534`*^9, 
   3.6132816698701577`*^9}, {3.636364808226494*^9, 3.636364817466494*^9}, {
   3.6366127819191*^9, 3.636612804748872*^9}, 3.645416668887431*^9, {
   3.655884272181464*^9, 3.6558842772359934`*^9}, {3.6578833089205523`*^9, 
   3.657883309513356*^9}, {3.657883629207206*^9, 3.6578836296752086`*^9}, {
   3.6578841800122585`*^9, 3.6578841841774855`*^9}, {3.6579119907371144`*^9, 
   3.6579119913361483`*^9}, {3.65794566684623*^9, 3.6579456706670294`*^9}, {
   3.657961988592587*^9, 3.6579619893725967`*^9}, 3.662192235486985*^9, {
   3.666503779967811*^9, 3.666503786457411*^9}, {3.6717807483599014`*^9, 
   3.6717807524003015`*^9}, {3.6754891069132576`*^9, 
   3.6754891131032577`*^9}, {3.6754891839226575`*^9, 
   3.6754891845226574`*^9}, {3.682670108061674*^9, 3.682670115638189*^9}, {
   3.682670484848441*^9, 3.6826704999127445`*^9}, {3.6957292277115517`*^9, 
   3.6957292279205723`*^9}, {3.7271509382335196`*^9, 3.7271509392566223`*^9}, 
   3.739509679791045*^9, 3.7395133319310455`*^9, 3.7395139577610455`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.6957198861471925`*^9, 3.695719890674842*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Options", "[", "simPedigreeInfor", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Options", "[", "magicGeneDropping", "]"}]}], "Input",
 CellChangeTimes->{{3.6957247851618657`*^9, 3.6957247965543985`*^9}, 
   3.695729553315583*^9, 3.6972099227187347`*^9, {3.7130896766042233`*^9, 
   3.713089677020265*^9}, {3.713089851314839*^9, 3.713089853866094*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"sampleSize", "\[Rule]", "100"}], ",", 
   RowBox[{"sampleGender", "\[Rule]", "\<\"Hermaphrodite\"\>"}], ",", 
   RowBox[{"funnelFunction", "\[Rule]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"RandomSample", "[", "#1", "]"}], "&"}], ")"}]}], ",", 
   RowBox[{"outputFileID", "\[Rule]", "\<\"\"\>"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6957245134142118`*^9, 3.6957247973224754`*^9, 3.695725083271557*^9, 
   3.69572523833877*^9, 3.695725653069254*^9, 3.6957270570215807`*^9, 
   3.695729224517232*^9, {3.695729263964176*^9, 3.695729292761647*^9}, {
   3.6957295277206297`*^9, 3.6957295588011312`*^9}, {3.6957295996380033`*^9, 
   3.695729623962224*^9}, 3.695729927589452*^9, 3.6957301844838395`*^9, 
   3.6957304921380763`*^9, 3.6959614383210363`*^9, 3.695964563639406*^9, 
   3.695971311803006*^9, 3.6959713670430064`*^9, {3.6959759576115065`*^9, 
   3.695975965827506*^9}, 3.6959764495127068`*^9, 3.6959770864791064`*^9, 
   3.697209924828945*^9, 3.697272819275679*^9, {3.6972733367434034`*^9, 
   3.697273350731394*^9}, 3.6972734959574547`*^9, 3.6972747695822644`*^9, 
   3.69727482120501*^9, 3.699855466599803*^9, 3.6998555371426373`*^9, 
   3.7009959185842805`*^9, 3.700996399032567*^9, 3.700996863427046*^9, 
   3.70099856104636*^9, {3.700999033515208*^9, 3.700999066062046*^9}, {
   3.7009992539837875`*^9, 3.7009992633534503`*^9}, 3.700999961126775*^9, 
   3.701000098911573*^9, 3.701000223817973*^9, 3.701000277824973*^9, 
   3.7015812999933147`*^9, 3.7129102631196795`*^9, 3.7130896774013033`*^9, 
   3.713089780332369*^9, 3.713089854366144*^9, 3.713089937001976*^9, 
   3.7130899868021455`*^9, {3.71309086390961*^9, 3.713090890699289*^9}, 
   3.7271508592752447`*^9, 3.7271509461823144`*^9, 3.7395082423270454`*^9, 
   3.739508331927045*^9, 3.739509121429045*^9, 3.739509274163045*^9, 
   3.7395093176310453`*^9, 3.7395093676360455`*^9, 3.7395094727960453`*^9, 
   3.739510116337045*^9, 3.739513343923045*^9, 3.7395138934280453`*^9, 
   3.7395139594350452`*^9, 3.739515474771045*^9, 3.741593142111349*^9, 
   3.744625671910399*^9, {3.744626395807599*^9, 3.744626411848199*^9}, 
   3.744627276625799*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"founderAllelicError", "\[Rule]", "0.005`"}], ",", 
   RowBox[{"offspringAllelicError", "\[Rule]", "0.005`"}], ",", 
   RowBox[{"isFounderInbred", "\[Rule]", "True"}], ",", 
   RowBox[{"dropMonomorphic", "\[Rule]", "False"}], ",", 
   RowBox[{"interferenceStrength", "\[Rule]", "0"}], ",", 
   RowBox[{"isObligate", "\[Rule]", "False"}], ",", 
   RowBox[{"phredQualScore", "\[Rule]", "30"}], ",", 
   RowBox[{"founderGenotypeMissing", "\[Rule]", "0"}], ",", 
   RowBox[{"founderReadDepth", "\[Rule]", "0"}], ",", 
   RowBox[{"offspringGenotypeMissing", "\[Rule]", "0"}], ",", 
   RowBox[{"offspringReadDepth", "\[Rule]", "0"}], ",", 
   RowBox[{"depthDistribution", "\[Rule]", "\<\"NegativeBinomial-1\"\>"}], 
   ",", 
   RowBox[{"outputFileID", "\[Rule]", "\<\"\"\>"}], ",", 
   RowBox[{"isPrintTimeElapsed", "\[Rule]", "True"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6957245134142118`*^9, 3.6957247973224754`*^9, 3.695725083271557*^9, 
   3.69572523833877*^9, 3.695725653069254*^9, 3.6957270570215807`*^9, 
   3.695729224517232*^9, {3.695729263964176*^9, 3.695729292761647*^9}, {
   3.6957295277206297`*^9, 3.6957295588011312`*^9}, {3.6957295996380033`*^9, 
   3.695729623962224*^9}, 3.695729927589452*^9, 3.6957301844838395`*^9, 
   3.6957304921380763`*^9, 3.6959614383210363`*^9, 3.695964563639406*^9, 
   3.695971311803006*^9, 3.6959713670430064`*^9, {3.6959759576115065`*^9, 
   3.695975965827506*^9}, 3.6959764495127068`*^9, 3.6959770864791064`*^9, 
   3.697209924828945*^9, 3.697272819275679*^9, {3.6972733367434034`*^9, 
   3.697273350731394*^9}, 3.6972734959574547`*^9, 3.6972747695822644`*^9, 
   3.69727482120501*^9, 3.699855466599803*^9, 3.6998555371426373`*^9, 
   3.7009959185842805`*^9, 3.700996399032567*^9, 3.700996863427046*^9, 
   3.70099856104636*^9, {3.700999033515208*^9, 3.700999066062046*^9}, {
   3.7009992539837875`*^9, 3.7009992633534503`*^9}, 3.700999961126775*^9, 
   3.701000098911573*^9, 3.701000223817973*^9, 3.701000277824973*^9, 
   3.7015812999933147`*^9, 3.7129102631196795`*^9, 3.7130896774013033`*^9, 
   3.713089780332369*^9, 3.713089854366144*^9, 3.713089937001976*^9, 
   3.7130899868021455`*^9, {3.71309086390961*^9, 3.713090890699289*^9}, 
   3.7271508592752447`*^9, 3.7271509461823144`*^9, 3.7395082423270454`*^9, 
   3.739508331927045*^9, 3.739509121429045*^9, 3.739509274163045*^9, 
   3.7395093176310453`*^9, 3.7395093676360455`*^9, 3.7395094727960453`*^9, 
   3.739510116337045*^9, 3.739513343923045*^9, 3.7395138934280453`*^9, 
   3.7395139594350452`*^9, 3.739515474771045*^9, 3.741593142111349*^9, 
   3.744625671910399*^9, {3.744626395807599*^9, 3.744626411848199*^9}, 
   3.744627276643799*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "founderhaplofile", "=", "\"\<Arabidopsis_MAGIC_19FounderHaplo.csv\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outputid", "=", "\"\<Example\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Switch", "[", 
    RowBox[{
     RowBox[{"RandomChoice", "[", 
      RowBox[{"Range", "[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     "1", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Simulating pedinfor from string code!\>\"", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"popcode", "=", "\"\<4wayril-self3\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"simpedinforfile", "=", 
       RowBox[{"simPedigreeInfor", "[", 
        RowBox[{"popcode", ",", 
         RowBox[{"sampleSize", "\[Rule]", "size"}], ",", 
         RowBox[{"outputFileID", "\[Rule]", "outputid"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "2", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Simulating pedinfor from mating schemes!\>\"", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"nfounder", "=", "4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"matescheme", "=", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Pairing\>\"", ",", "\"\<Pairing\>\"", ",", "\"\<Selfing\>\"", 
         ",", "\"\<Selfing\>\"", ",", "\"\<Selfing\>\""}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"simpedinforfile", "=", 
       RowBox[{"simPedigreeInfor", "[", 
        RowBox[{"nfounder", ",", "matescheme", ",", 
         RowBox[{"sampleSize", "\[Rule]", "size"}], ",", 
         RowBox[{"outputFileID", "\[Rule]", "outputid"}]}], "]"}]}]}], ",", 
     "\[IndentingNewLine]", "3", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Print", "[", "\"\<Simulating pedinfor from pedigree!\>\"", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pedigree0", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Generation\>\"", ",", "\"\<MemberID\>\"", ",", 
           "\"\<Female=1/Male=2/Hermaphrodite=0\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<MotherID\>\"", ",", "\"\<FatherID\>\""}], "}"}]}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "3", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "4", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "6", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "4"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "7", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"5", ",", "6"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "8", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"7", ",", "7"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "9", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"8", ",", "8"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "0", ",", 
           RowBox[{"{", 
            RowBox[{"9", ",", "9"}], "}"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"simpedinforfile", "=", 
       RowBox[{"simPedigreeInfor", "[", 
        RowBox[{"pedigree0", ",", 
         RowBox[{"sampleSize", "\[Rule]", "size"}], ",", 
         RowBox[{"outputFileID", "\[Rule]", "outputid"}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"pedigree", "===", "pedigree0"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pedigree", "=", 
   RowBox[{
    RowBox[{"splitPedigreeInfor", "[", 
     RowBox[{"Import", "[", "simpedinforfile", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pedigreePlot", "[", 
  RowBox[{"pedigree", ",", 
   RowBox[{"ImageSize", "\[Rule]", "150"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.695724147612956*^9, 3.695724157387525*^9}, {
   3.695724671725771*^9, 3.6957247591210794`*^9}, {3.6957252357215085`*^9, 
   3.695725236649601*^9}, {3.695725644167969*^9, 3.6957256470238533`*^9}, 
   3.6957270551463933`*^9, {3.695729245304311*^9, 3.6957292904746227`*^9}, {
   3.6957296202548532`*^9, 3.6957296224220695`*^9}, {3.695730175377929*^9, 
   3.6957301821776094`*^9}, {3.6959713027676067`*^9, 3.695971310182206*^9}, {
   3.6959713631868067`*^9, 3.6959713652504063`*^9}, {3.6959759555489063`*^9, 
   3.6959759627295065`*^9}, {3.695976443017906*^9, 3.6959764479233065`*^9}, {
   3.6959770802183065`*^9, 3.6959770806173067`*^9}, 3.697209919743437*^9, {
   3.697209955217984*^9, 3.697209974773939*^9}, {3.7009963054138193`*^9, 
   3.700996306981976*^9}, {3.700996356176486*^9, 3.700996385625431*^9}, {
   3.700996819841096*^9, 3.7009968221613283`*^9}, {3.700999045888241*^9, 
   3.7009990563126774`*^9}, {3.7009992496946163`*^9, 3.700999261929593*^9}, {
   3.701000256479373*^9, 3.7010002764739733`*^9}, {3.7130897186216145`*^9, 
   3.7130898238178997`*^9}, {3.713089861029007*^9, 3.7130898675276575`*^9}, {
   3.713089898965786*^9, 3.7130899231655927`*^9}, {3.7130899793037972`*^9, 
   3.7130899854790134`*^9}, {3.7271508535190783`*^9, 3.727150857701088*^9}, 
   3.7395082556950455`*^9, {3.7395082979780455`*^9, 3.7395083292500453`*^9}, 
   3.739508601337045*^9, {3.739508689852045*^9, 3.7395088901650453`*^9}, {
   3.7395089497540455`*^9, 3.739509090705045*^9}, {3.7395093447020454`*^9, 
   3.7395093499920454`*^9}, {3.7395094243880453`*^9, 3.7395094458820453`*^9}}],

Cell[BoxData["\<\"Simulating pedinfor from pedigree!\"\>"], "Print",
 CellChangeTimes->{
  3.7395090911100454`*^9, {3.739509121552045*^9, 3.739509145201045*^9}, 
   3.7395092742700453`*^9, 3.739509317779045*^9, 3.7395093677630453`*^9, 
   3.739509472878045*^9, 3.739510116424045*^9, 3.739513343983045*^9, 
   3.739513893512045*^9, 3.7395139595390453`*^9, 3.739515474884045*^9, 
   3.741593142173355*^9, 3.744625671966399*^9, {3.744626395866599*^9, 
   3.744626411905199*^9}, 3.744627276692799*^9}],

Cell[BoxData[
 GraphicsBox[
  TagBox[GraphicsGroupBox[{GraphicsComplexBox[CompressedData["
1:eJxt0n1IU1EYx/E7wxWFkmIFSlgmJGXgCyiadg669I8CXRBZKDU1BQl8A/2j
EkVKDS2DiKYloplZkFAW01GPhZmVL6iVBBoyptkUyykh6SI37znCjw6Mw8M5
7N7PvtubnnvivJuiKDlrH+e+vpZpfffh6/ukOm+HWZ6z/8/i/jKci7UFZgXm
XwzOlW4eGJyQVsdWJhoGdxzazHm0Uj5f1MjmDwSNpy1peW1chOYZa2ZDs1lh
UWYtz7Nk+HpVtrAnkc3mzjItV15WGPVJrex5z92ShUQtT6442zN16yHz8rfe
sXtoeWn8/srslDbWbgqOGhp1541G52pjrs24MWdnOZebvK9PHO0NCXbjXP2+
n5N+2R52jXzescMZZZ4mDT+nvo++L1WXUKLhper7hvgYB3p1Gh6ierw/j+1r
2rZ2rnrdAwyhthGFq34CP4GfwE/gJ/AT+An8BH4CP4GfwE/gJ/AT+An8BH72
2xx77+CZv0z0Hz+ZbDLPOJjo3zA2kFlQ5GCif2puQnHhJgcTPXKqohyWG6tM
9A840hc65bfKRM+0/NMFDa0rTPQODXeujXmw37mW5P2m6w9qDClLTPSfeB05
6GtdlM+7XdTrtjtvkYn+zbWdldWrdib6G4LC6muq7Ez0D3zUnqjbtXauerfq
3qR/allgoj/4CfwEfgI/gZ/AT+An8BP4CfwEfgI/gZ/AT+An8DNb8cXoUx1z
sv+Lx415xcOzsn9Me/1765xN9jd9q56f1tpkjxHvwj9v/X/I/vGXajM+RM7I
nl2Wp9aYpO+yd7rr/z4tZ9fPET4q75dH10VcNQzL/hbPV/lf9gzJ593vCN85
U/pR9ve80n800/pO9nfE3fx64XiP7O+jvxwb0NUt+19z7V2yP/gJ/AR+Aj+B
n8BP4CfwE/gJ/AR+Aj+Bn8BP4Cfh/wf7O90X
      "], 
      {RGBColor[0.5, 0., 0.], Arrowheads[{{0.023064257028112448`, 0.7}}], 
       ArrowBox[{1, 2}], ArrowBox[{2, 7}], ArrowBox[{3, 2}], ArrowBox[{4, 5}],
        ArrowBox[{5, 7}], ArrowBox[{6, 5}], 
       ArrowBox[{7, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 
        25, 26, 8}], 
       ArrowBox[{7, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 
        41, 42, 8}], 
       ArrowBox[{8, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 
        57, 58, 9}], 
       ArrowBox[{8, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 
        73, 74, 9}], 
       ArrowBox[{9, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 
        89, 90, 10}], 
       ArrowBox[{9, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 
        104, 105, 106, 10}]}], {
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{-1.5, 5.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["1",
          StripOnInput->False,
          FontSize->12], {-1.5, 5.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{-0.5, 4.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["5",
          StripOnInput->False,
          FontSize->12], {-0.5, 4.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{-0.5, 5.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["2",
          StripOnInput->False,
          FontSize->12], {-0.5, 5.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{0.5, 5.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["3",
          StripOnInput->False,
          FontSize->12], {0.5, 5.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{0.5, 4.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["6",
          StripOnInput->False,
          FontSize->12], {0.5, 4.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{1.5, 5.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["4",
          StripOnInput->False,
          FontSize->12], {1.5, 5.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{0., 3.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["7",
          StripOnInput->False,
          FontSize->12], {0., 3.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{0., 2.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["8",
          StripOnInput->False,
          FontSize->12], {0., 2.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{0., 1.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["9",
          StripOnInput->False,
          FontSize->12], {0., 1.}]}}, 
      {RGBColor[1, 1, 0.85], Opacity[0.5], EdgeForm[RGBColor[1, 0, 0]], 
       DiskBox[{0., 0.}, 0.2], 
       {GrayLevel[0], InsetBox[
         StyleBox["10",
          StripOnInput->False,
          FontSize->12], {0., 0.}]}}}},
    ContentSelectable->True],
   Annotation[#, 
    VertexCoordinateRules -> {{-1.5, 5.}, {-0.5, 4.}, {-0.5, 5.}, {0.5, 5.}, {
     0.5, 4.}, {1.5, 5.}, {0., 3.}, {0., 2.}, {0., 1.}, {0., 0.}}]& ],
  AspectRatio->Automatic,
  FrameTicks->None,
  ImageMargins->0.,
  ImageSize->150,
  PlotRange->All,
  PlotRangePadding->Scaled[0.1]]], "Output",
 CellChangeTimes->{{3.6957247422392015`*^9, 3.695724759608128*^9}, 
   3.695724802493993*^9, 3.69572508330256*^9, 3.6957252383617725`*^9, 
   3.695725653101257*^9, 3.6957270570475836`*^9, {3.695729263983178*^9, 
   3.6957292927856493`*^9}, 3.695729527754633*^9, 3.6957295588401356`*^9, {
   3.6957295996600056`*^9, 3.6957296239892263`*^9}, 3.6957299276124544`*^9, 
   3.695730184521844*^9, 3.6957304921570787`*^9, 3.6959614383490305`*^9, 
   3.695964563665406*^9, 3.6959713118370066`*^9, 3.6959713670760064`*^9, {
   3.6959759576425066`*^9, 3.6959759658705063`*^9}, 3.6959764495447063`*^9, 
   3.6959770865131063`*^9, 3.697209928050267*^9, 3.6972099753369956`*^9, 
   3.6972733507523956`*^9, 3.6972734959834576`*^9, 3.697274769610267*^9, 
   3.697274821230013*^9, 3.69985546677682*^9, 3.699855537280651*^9, {
   3.700996351033972*^9, 3.7009963991075745`*^9}, 3.7009968268357954`*^9, 
   3.700996863600063*^9, 3.700998561078363*^9, {3.700999059398986*^9, 
   3.7009990661442513`*^9}, {3.7009992540137844`*^9, 3.700999263381448*^9}, 
   3.700999961145775*^9, 3.701000098935573*^9, 3.701000223850973*^9, 
   3.701000277858973*^9, 3.7015813000133286`*^9, 3.7129102631416817`*^9, {
   3.713089780360372*^9, 3.713089829869505*^9}, 3.7130898679216967`*^9, {
   3.7130899027501645`*^9, 3.7130899370659823`*^9}, 3.713089986854151*^9, {
   3.7130908639566145`*^9, 3.7130908907514915`*^9}, 3.727150859366254*^9, 
   3.727150946260322*^9, {3.7395082439140453`*^9, 3.739508256203045*^9}, 
   3.7395083320110455`*^9, {3.739508684350045*^9, 3.7395086929070454`*^9}, {
   3.7395087440130453`*^9, 3.739508761498045*^9}, 3.7395088647800455`*^9, 
   3.739509026258045*^9, 3.7395090910720453`*^9, {3.739509121519045*^9, 
   3.7395091451690454`*^9}, 3.7395092742400455`*^9, 3.7395093177470455`*^9, 
   3.7395093678160453`*^9, 3.7395094733410454`*^9, 3.739510117038045*^9, 
   3.739513344363045*^9, 3.739513893656045*^9, 3.739513960083045*^9, 
   3.739515475437045*^9, 3.74159314221836*^9, 3.744625672334399*^9, {
   3.744626396243599*^9, 3.744626411969199*^9}, 3.744627277051799*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"datafiles", "=", 
  RowBox[{"magicGeneDropping", "[", 
   RowBox[{"founderhaplofile", ",", "simpedinforfile", ",", 
    RowBox[{"dropMonomorphic", "\[Rule]", "True"}], ",", 
    RowBox[{"outputFileID", "\[Rule]", "outputid"}], ",", 
    RowBox[{"isFounderInbred", "\[Rule]", "True"}], ",", 
    RowBox[{"founderGenotypeMissing", "\[Rule]", "0.1"}], ",", 
    RowBox[{"founderReadDepth", "\[Rule]", "0"}], ",", 
    RowBox[{"offspringGenotypeMissing", "\[Rule]", "0.1"}], ",", 
    RowBox[{"offspringReadDepth", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7130908814563646`*^9, 3.7130908848076997`*^9}, {
   3.7271508887835827`*^9, 3.727150890630767*^9}, {3.727150968354721*^9, 
   3.7271509696178474`*^9}, 3.7395082664710455`*^9, 3.739508313179045*^9, {
   3.739509217482045*^9, 3.739509218069045*^9}, {3.739509313965045*^9, 
   3.739509314608045*^9}, {3.7395099513130455`*^9, 3.739509954904045*^9}, {
   3.7395100960960455`*^9, 3.7395100963750453`*^9}, 3.7395138915960455`*^9, {
   3.739515465575245*^9, 3.739515473062045*^9}, {3.7415931335264926`*^9, 
   3.7415931392700653`*^9}, {3.744626403805399*^9, 3.744626404058399*^9}, {
   3.744627274043799*^9, 3.744627274370799*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"magicGeneDropping. Start date = \"\>", 
   "\[InvisibleSpace]", "\<\"Thu 30 Aug 2018 16:14:37\"\>"}],
  SequenceForm["magicGeneDropping. Start date = ", "Thu 30 Aug 2018 16:14:37"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627277207799*^9}],

Cell[BoxData["\<\"Time elapsed = 0. Seconds. \\tStart simulating offspring \
genomes in terms of FGL lists.\"\>"], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627277234799*^9}],

Cell[BoxData["\<\"Time elapsed = 2.9 Seconds. \\tStart dropping founder \
alleles on the offspring FGL lists.\"\>"], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627280139799*^9}],

Cell[BoxData["\<\"Time elapsed = 3.7 Seconds. \\tStart simulating allelic \
errors in founders and offspring.\"\>"], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627280893799*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The realized fraction of missing genotypes in founders: \"\>", 
   "\[InvisibleSpace]", "0.106`"}],
  SequenceForm[
  "The realized fraction of missing genotypes in founders: ", 0.106],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627280968799*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"The realized fraction of missing genotypes in offspring: \"\>",
    "\[InvisibleSpace]", "0.10300000000000001`"}],
  SequenceForm[
  "The realized fraction of missing genotypes in offspring: ", 
   0.10300000000000001`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627280990799*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Saving true values and simulated data. \"\>", 
   "\[InvisibleSpace]", "\<\"Thu 30 Aug 2018 16:14:41\"\>", 
   "\[InvisibleSpace]", "\<\"\\n\\t\"\>", "\[InvisibleSpace]", 
   TagBox[GridBox[{
      {"\<\"True FGL\"\>", "\<\"Example_TrueValues_Fgl.txt\"\>"},
      {"\<\"True FGL diplotype\"\>", "\<\"Example_TrueValues_FglDiplotype.csv\
\"\>"},
      {"\<\"True diplotype\"\>", "\<\"Example_TrueValues_Diplotype.csv\"\>"},
      {"\<\"Observed genotype\"\>", "\<\"Example_ObservedGenotype.csv\"\>"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[2.0999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$]]]}],
  SequenceForm[
  "Saving true values and simulated data. ", "Thu 30 Aug 2018 16:14:41", 
   "\n\t", 
   TableForm[{{"True FGL", "Example_TrueValues_Fgl.txt"}, {
     "True FGL diplotype", "Example_TrueValues_FglDiplotype.csv"}, {
     "True diplotype", "Example_TrueValues_Diplotype.csv"}, {
     "Observed genotype", "Example_ObservedGenotype.csv"}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627281042799*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Done! Finished date =\"\>", 
   "\[InvisibleSpace]", "\<\"Thu 30 Aug 2018 16:14:41\"\>", 
   "\[InvisibleSpace]", "\<\". \\tTime elapsed = \"\>", "\[InvisibleSpace]", 
   "4.6000000000000005`", "\[InvisibleSpace]", "\<\" Seconds.\"\>"}],
  SequenceForm[
  "Done! Finished date =", "Thu 30 Aug 2018 16:14:41", ". \tTime elapsed = ", 
   4.6000000000000005`, " Seconds."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7130908641756363`*^9, 3.713090890953511*^9}, 
   3.727150859915309*^9, 3.7271508973390365`*^9, {3.727150946857382*^9, 
   3.727150970062892*^9}, 3.739508267302045*^9, 3.739508332344045*^9, 
   3.739509121828045*^9, 3.739509275038045*^9, 3.739509318021045*^9, 
   3.7395093679900455`*^9, 3.739509473602045*^9, 3.7395101173080454`*^9, 
   3.739513344529045*^9, 3.739513893847045*^9, 3.739513960340045*^9, 
   3.7395154756970453`*^9, 3.7415931423483725`*^9, 3.744625672508399*^9, {
   3.744626396396599*^9, 3.744626412094199*^9}, 3.744627281808799*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Example_TrueValues_Fgl.txt\"\>", 
   ",", "\<\"Example_TrueValues_FglDiplotype.csv\"\>", 
   ",", "\<\"Example_TrueValues_Diplotype.csv\"\>", 
   ",", "\<\"Example_ObservedGenotype.csv\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.713089934031679*^9, 3.7130899554264097`*^9}, 
   3.713090010740736*^9, 3.713090405803136*^9, {3.7130908876859875`*^9, 
   3.713090909234135*^9}, 3.727150864486766*^9, 3.727150898834186*^9, {
   3.7271509484483366`*^9, 3.727150972364721*^9}, 3.739508271259045*^9, 
   3.739508340460045*^9, 3.7395091298790455`*^9, 3.7395092838150454`*^9, 
   3.7395093254990454`*^9, 3.739509375549045*^9, 3.7395094806220455`*^9, 
   3.7395101272040453`*^9, 3.739513349807045*^9, 3.739513902134045*^9, 
   3.739513968517045*^9, 3.739515487641845*^9, 3.7415931470148373`*^9, 
   3.744625677355399*^9, {3.744626401182399*^9, 3.744626416793199*^9}, 
   3.744627281830799*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
    "**"}], "******)"}]], "Input",
 CellChangeTimes->{{3.6957198861471925`*^9, 3.695719890674842*^9}}]
},
WindowSize->{1920, 980},
WindowMargins->{{-9, Automatic}, {Automatic, -9}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 2027, 36, 86, "Input"],
Cell[2587, 58, 469, 8, 37, "Input"],
Cell[CellGroupData[{
Cell[3081, 70, 372, 5, 62, "Input"],
Cell[3456, 77, 2179, 35, 37, "Output"],
Cell[5638, 114, 2704, 43, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8379, 162, 6315, 137, 542, "Input"],
Cell[14697, 301, 497, 7, 28, "Print"],
Cell[15197, 310, 6588, 132, 315, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21822, 447, 1219, 19, 62, "Input"],
Cell[CellGroupData[{
Cell[23066, 470, 832, 13, 28, "Print"],
Cell[23901, 485, 695, 9, 28, "Print"],
Cell[24599, 496, 697, 9, 28, "Print"],
Cell[25299, 507, 697, 9, 28, "Print"],
Cell[25999, 518, 836, 14, 28, "Print"],
Cell[26838, 534, 871, 15, 28, "Print"],
Cell[27712, 551, 1993, 39, 111, "Print"],
Cell[29708, 592, 1021, 17, 28, "Print"]
}, Open  ]],
Cell[30744, 612, 930, 15, 37, "Output"]
}, Open  ]],
Cell[31689, 630, 469, 8, 37, "Input"]
}
]
*)

